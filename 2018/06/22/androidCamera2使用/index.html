<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>androidCamera2使用 | CallteFoot&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Camera2 介绍&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;从android5.0开始对相机的API进行了全新的设计，这些API都在android.hardware.camera2包下，也是为了区分之前的API，新API不仅大幅提高了Android系统拍照等功能，还支持RAW照片输出，甚至允许程序调整相机的对焦模式、曝光模式、快门等。官网给出的说明如下：Camera2 API    Sup">
<meta name="keywords" content="andrid,Camera2">
<meta property="og:type" content="article">
<meta property="og:title" content="androidCamera2使用">
<meta property="og:url" content="https://cattlefoot.github.io/2018/06/22/androidCamera2使用/index.html">
<meta property="og:site_name" content="CallteFoot&#39;s blog">
<meta property="og:description" content="Camera2 介绍&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;从android5.0开始对相机的API进行了全新的设计，这些API都在android.hardware.camera2包下，也是为了区分之前的API，新API不仅大幅提高了Android系统拍照等功能，还支持RAW照片输出，甚至允许程序调整相机的对焦模式、曝光模式、快门等。官网给出的说明如下：Camera2 API    Sup">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://cattlefoot.github.io/images/Camera2Flow.png">
<meta property="og:image" content="https://cattlefoot.github.io/images/Camera2Classes.png">
<meta property="og:image" content="https://cattlefoot.github.io/images/Camera2Step.png">
<meta property="og:updated_time" content="2018-06-26T02:11:06.749Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="androidCamera2使用">
<meta name="twitter:description" content="Camera2 介绍&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;从android5.0开始对相机的API进行了全新的设计，这些API都在android.hardware.camera2包下，也是为了区分之前的API，新API不仅大幅提高了Android系统拍照等功能，还支持RAW照片输出，甚至允许程序调整相机的对焦模式、曝光模式、快门等。官网给出的说明如下：Camera2 API    Sup">
<meta name="twitter:image" content="https://cattlefoot.github.io/images/Camera2Flow.png">
  
    <link rel="alternate" href="/atom.xml" title="CallteFoot&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">CallteFoot&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://cattlefoot.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-androidCamera2使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/22/androidCamera2使用/" class="article-date">
  <time datetime="2018-06-22T05:39:38.000Z" itemprop="datePublished">2018-06-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      androidCamera2使用
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Camera2-介绍"><a href="#Camera2-介绍" class="headerlink" title="Camera2 介绍"></a>Camera2 介绍</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;从android5.0开始对相机的API进行了全新的设计，这些API都在android.hardware.camera2包下，也是为了区分之前的API，新API不仅大幅提高了Android系统拍照等功能，还支持RAW照片输出，甚至允许程序调整相机的对焦模式、曝光模式、快门等。官网给出的说明如下：<br>Camera2 API  </p>
<ul>
<li>Supports 30fps full resolution with burst mode<br>支持30fps的全高清连拍</li>
<li>Supports change on manual camera settings between frame capture<br>支持帧之间的手动设置</li>
<li>Supports RAW image capture<br>支持RAW格式的图片拍摄</li>
<li>Supports Zero Shutter Lag &amp; Movie Snapshot<br>支持快门0延迟以及电影速拍</li>
<li>Supports setting other manual camera device controls including level of Noise Cancelling<br>支持相机其他方面的手动控制包括噪音消除的级别</li>
</ul>
<ol>
<li><p>Camera2工作流程示意图：<br><img src="/images/Camera2Flow.png" alt="camera2流程示意图"><br>&nbsp;&nbsp;&nbsp;&nbsp;Google采用了pipeline（管道）的概念，将Camera Device相机设备和Android Device安卓设备连接起来， Android Device通过管道发送CaptureRequest拍照请求给Camera Device，Camera Device通过管道返回CameraMetadata数据给Android Device，这一切建立在一个叫作CameraCaptureSession的会话中。  </p>
</li>
<li><p>Camera2类图：<br><img src="/images/Camera2Classes.png" alt="camera2类图"><br>&nbsp;&nbsp;&nbsp;&nbsp;其中CameraManager是所有相机设备（CameraDevice）的管理者，而每个CameraDevice自己会负责建立CameraCaptureSession以及建立CaptureRequest。CameraCharacteristics是CameraDevice的属性描述类，在CameraCharacteristics中可以进行相机设备功能的详细设定（当然了，首先你得确定你的相机设备支持这些功能才行）类图中有着三个重要的callback，其中CameraCaptureSession.CaptureCallback将处理预览和拍照图片的工作，需要重点对待。</p>
</li>
</ol>
<p>以上的类是如何相互配合的？下面是拍照的流程图：<br><img src="/images/Camera2Step.png" alt="camera2类图">       </p>
<ol>
<li>调用openCamera方法后会回调CameraDevice.StateCallback方法，该方法重写onPened函数；</li>
<li>在onOpened方法中调用createCaptureSession方法，该方法又回调CameraCaptureSession.StateCallback方法。</li>
<li>在CameraCaptureSession.StateCallback中重写onConfigured方法，设置setRepeatingRequest方法（也即开启预览）；</li>
<li>在setRepeatingRequest又会回调CameraCaptureSession.CaptureCallback方法；</li>
<li>重写CameraCaptureSession.CaptureCallback中的onCaptureCompleted方法，result就是未经过处理的元数据；  </li>
</ol>
<p>其中onCaptureProgressed方法很明显是在Capture过程中的，也就是在onCaptureCompleted之前，所以，在这之前相对图像干什么就看你的了，像美颜等操作就可以在这个方法中实现了。  </p>
<p>由此也可以看出Camera2相机使用还是简单的，其实就是3个Callback函数的回调，先说一下：setRepeatingRequest和capture方法其实都是向相机设备发送获取图像的请求，但是capture就获取那么一次，而setRepeatingRequest就是不停的获取图像数据，所以呢，使用capture就想拍照一样，图像就停在那里了，但是setRepeatingRequest一直在发送和获取，所以需要连拍的时候就调用它，然后在onCaptureCompleted中保存图像就行了。（注意了，图像的预览也是用的setRepeatingRequest，只要不处理数据就行了），从上面我们也了解到Camera2运用主要用到这些类：CameraManager、CameraDevice、CameraCharacteristics、CameraRequest与CameraRequest.Builder、CameraCaptureSession以及CaptureResult。  </p>
<ol>
<li><p>CameraManager：位于android.hardware.camera2.CameraManager下，也是Android 21(5.0)添加的，和其他系统服务一样通过 Context.getSystemService(CameraManager.class ) 或者Context.getSystemService(Context.CAMERA_SERVICE) 来完成初始化，主要用于管理系统摄像头：</p>
<ul>
<li>通过getCameraIdList()方法获取Android设备的摄像头列表，如今手机基本都有前后摄像头，有的手机则更多；  </li>
<li>通过getCameraIdList()方法获取Android设备的摄像头列表；  </li>
<li>openCamera(String cameraId, CameraDevice.StateCallback callback, Handler handler)打开指定Id的摄像头；  </li>
</ul>
</li>
<li><p>CameraDevice：CameraDevice是Camera2中抽象出来的一个对象，直接与系统硬件摄像头相联系。因为不可能所有的摄像头都会支持高级功能（即摄像头功能可被分为limit 和full 两个级别），当摄像头处于limited 级别时候，此时Camera2和早期的Camera功能差不多，除此之外在Camera2架构中，CameraDevice还承担其他两项重要任务：</p>
<ul>
<li>通过CameraDevice.StateCallback监听摄像头的状态（主要包括onOpened、onClosed、onDisconnected、onErro四种状态）；</li>
<li>管理CameraCaptureSession，通过方法createCaptureSession(List<surface> outputs, CameraCaptureSession.StateCallback callback, Handler handler)方法和createReprocessableCaptureSession(InputConfiguration inputConfig, List<surface> outputs, CameraCaptureSession.StateCallback callback, Handler handler)方法创建会话 （其中第三个参数： The handler on which the callback should be invoked, or null to use the current thread’s looper.），通常会在CameraDevice.StateCallback中调用对应方法创建预览会话。</surface></surface></li>
<li>管理CaptureRequest，主要包括通过createCaptureRequest（int templateType）创建捕获请求，在需要预览、拍照、再次预览的时候都需要通过创建请求来完成；</li>
</ul>
</li>
<li><p>CameraCaptureSession：系统向摄像头发送 Capture 请求，而摄像头会返回 CameraMetadata，这一切都是在由对应的 <strong>CameraDevice创建的CameraCaptureSession 会话</strong> 完成，当程序需要预览、拍照、再次预览时，都需要先通过会话。（A configured capture session for a CameraDevice, used for capturing images from the camera or reprocessing images captured from the camera in the same session previously.A CameraCaptureSession is created by providing a set of target output surfaces to createCaptureSession, or by providing an InputConfiguration and a set of target output surfaces to createReprocessableCaptureSession for a reprocessable capture session. Once created, the session is active until a new session is created by the camera device, or the camera device is closed.）CameraCaptureSession一旦被创建，直到对应的CameraDevice关闭才会死掉。虽然CameraCaptureSession会话用于从摄像头中捕获图像，但是 <strong>只有同一个会话才能再次从同一摄像头中捕获图像</strong>。另外，创建会话是一项耗时的异步操作，可能需要几百毫秒，因为它需要配置相机设备的内部管道并分配内存缓冲区以将图像发送到所需的目标，因而createCaptureSession和createReprocessableCaptureSession会将随时可用的CameraCaptureSession发送到提供的监听器的onConfigured回调中。如果无法完成配置，则触发onConfigureFailed回调，并且会话将不会变为活动状态。最后需要注意的是，<strong>如果摄像头设备创建了一个新的会话，那么上一个会话是被关闭的，并且会回调与其关联的onClosed</strong>，如果不处理好，当会话关闭之后再次调用会话的对应方法那么所有方法将会跑出IllegalStateException异常。关闭的会话清除任何重复的请求（和调用了stopRepeating()方法类似），但是在新创建的会话接管并重新配置摄像机设备之前，关闭的会话仍然会正常完成所有正在进行的捕获请求。简而言之，在Camera2中CameraCaptureSession承担很重要的角色：</p>
<ul>
<li>管理CameraCaptureSession.StateCallback状态回调，用于接收有关CameraCaptureSession状态的更新的回调对象，主要回调方法有两个当CameraDevice 完成配置，对应的会话开始处理捕获请求时触发onConfigured(CameraCaptureSession session)方法，反之配置失败时候触发onConfigureFailed(CameraCaptureSession session)方法；  </li>
<li>管理CameraCaptureSession.CaptureCallback捕获回调，用于接收捕获请求状态的回调，当请求触发捕获已启动时；捕获完成时；在捕获图像时发生错误的情况下；都会触发该回调对应的方法；  </li>
<li>通过调用方法capture(CaptureRequest request, CameraCaptureSession.CaptureCallback listener, Handler handler)提交捕获图像请求（Submit a request for an image to be captured by the camera device.）即拍照，其中该请求定义了捕获单个图像的所有参数，包括传感器，镜头，闪光灯和后处理参数，每一次请求的结果将产生一个CaptureResult，可以为一个或多个Surface生成新的帧，然后 <strong>通过CaptureRequest.Builder的addTarget(Surface)方法附着到对应的Surface上显示</strong>，而且这个参数Surface必须是会话创建时候的一个子集，会话一次可以处理多个常规和重新处理请求。但如果只有常规请求或重新处理请求在进行，则以先进先出的顺序处理它们；如果两者都在进行中则分别以各自的先进先出顺序处理他们；然而，处理常规请求和重新处理请求的顺序并不是特定的，换言之，一个常规请求在下一个常规请求提交前被处理，同理重新处理请求也一样，但是一个常规请求不一定是在下一个重新处理请求提交之前被处理。通过capture方法提交的请求处理优先级比通过其他方式（ setRepeatingRequest(CaptureRequest, CameraCaptureSession.CaptureCallback, Handler) 或者setRepeatingBurst(List, CameraCaptureSession.CaptureCallback, Handler)）提交的请求的处理优先级高，一旦当前的repeat / repeatBurst处理完成，就会被处理。最后一点，所有CaptureSession可用于从相机捕获图像，但只有由createReprocessableCaptureSession创建的会话才可以提交重新处理捕获请求，<br>将重新处理请求提交到常规捕获会话将导致IllegalArgumentException；</li>
<li>通过调用方法setRepeatingRequest(CaptureRequest request, CameraCaptureSession.CaptureCallback listener, Handler handler)请求不断重复捕获图像，即实现预览；  </li>
<li>通过方法调用stopRepeating()实现停止捕获图像，即停止预览；  </li>
</ul>
<ol>
<li><p>CameraCharacteristics：描述Cameradevice属性的对象，可以使用CameraManager通过getCameraCharacteristics（String cameraId）进行查询；</p>
</li>
<li><p>CameraRequest和CameraRequest.Builder：CameraRequest代表了一次捕获请求，而 <strong>CameraRequest.Builder用于描述捕获图片的各种参数设置，包含捕获硬件（传感器，镜头，闪存），对焦模式、曝光模式，处理流水线，控制算法和输出缓冲区的配置</strong>。，然后传递到对应的会话中进行设置，CameraRequest.Builder则负责生成CameraRequest对象。当程序调用setRepeatingRequest()方法进行预览时，或调用capture()方法进行拍照时，都需要传入CameraRequest参数。CameraRequest可以通过CameraRequest.Builder来进行初始化，通过调用createCaptureRequest来获得；</p>
</li>
<li><p>CaptureResult：CaptureRequest描述是从图像传感器捕获单个图像的结果的子集的对象。（CaptureResults are produced by a CameraDevice after processing a CaptureRequest）当CaptureRequest被处理之后由CameraDevice生成；</p>
</li>
<li><p>Camera2 主要角色之间的联系：<strong>CameraManager</strong>处于顶层管理位置<strong>负责检测获取所有摄像头及其特性和传入指定的CameraDevice.StateCallback回调打开指定摄像头</strong>，<strong>CameraDevice</strong> 是负责管理抽象对象，包括 <strong>监听Camera 的状态回调CameraDevice.StateCallback、创建CameraCaptureSession和CameraRequest，CameraCaptureSession</strong> 用于描述一次图像捕获操作，主要负责 <strong>监听自己会话的状态回调CameraCaptureSession.StateCallback和CameraCaptureSession.CaptureCallback捕获回调</strong>，还有发送处理 <strong>CameraRequest；CameraRequest</strong> 则可以看成是一个”JavaBean”的作用用于描述希望什么样的配置来处理这次请求；最后三个回调用于监听对应的状态。</p>
</li>
</ol>
</li>
</ol>
<h3 id="Camera2-使用"><a href="#Camera2-使用" class="headerlink" title="Camera2 使用"></a>Camera2 使用</h3><ol>
<li>权限配置：  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//相机权限</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;</span><br><span class="line">//保存照片需要的权限</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;</span><br><span class="line">//录制视频需要的权限</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.RECORD_AUDIO&quot; /&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在6.0之后还需要在使用相机时动态判断是否具备权限：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private String[] permission = new String[]&#123;</span><br><span class="line">            Manifest.permission.CAMERA&#125;;</span><br><span class="line">if (ContextCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                   requestPermissions(permission, 101);</span><br><span class="line">                   return;</span><br><span class="line">               &#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>打开相机并实时预览：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">HandlerThread handlerThread=new HandlerThread(&quot;Camera2&quot;);</span><br><span class="line">handlerThread.start();</span><br><span class="line">Handler childHandler=new Handler(handlerThread.getLooper());</span><br><span class="line">handler mainHandler=new Handler(getMainLooper());</span><br><span class="line"></span><br><span class="line">private void initCamera() &#123;</span><br><span class="line"></span><br><span class="line">  CameraManager cameraManager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);</span><br><span class="line">  try &#123;</span><br><span class="line">      if (ActivityCompat.checkSelfPermission(this, Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">          return;</span><br><span class="line">      &#125;</span><br><span class="line">      //打开摄像头</span><br><span class="line">      cameraManager.openCamera(CameraCharacteristics.LENS_FACING_BACK + &quot;&quot;, stateCallback, mainHandler);</span><br><span class="line">  &#125; catch (CameraAccessException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//相机状态监听回调</span><br><span class="line">private CameraDevice.StateCallback stateCallback = new CameraDevice.StateCallback() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onOpened(CameraDevice camera) &#123;//打开摄像头</span><br><span class="line">        mCameraDevice = camera;</span><br><span class="line">        //开启预览</span><br><span class="line">        takePreview();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDisconnected(CameraDevice camera) &#123;//关闭摄像头</span><br><span class="line">        if (null != mCameraDevice) &#123;</span><br><span class="line">            mCameraDevice.close();</span><br><span class="line">            MainActivity.this.mCameraDevice = null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onError(CameraDevice camera, int error) &#123;//发生错误</span><br><span class="line">        Toast.makeText(MainActivity.this, &quot;摄像头开启失败&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 开始预览</span><br><span class="line"> */</span><br><span class="line">private void takePreview() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 创建预览需要的CaptureRequest.Builder</span><br><span class="line">        final CaptureRequest.Builder previewRequestBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);</span><br><span class="line">        // 将SurfaceView的surface作为CaptureRequest.Builder的目标</span><br><span class="line">        previewRequestBuilder.addTarget(surfaceHolder.getSurface());</span><br><span class="line">        // 创建CameraCaptureSession，该对象负责管理处理预览请求和拍照请求</span><br><span class="line">        mCameraDevice.createCaptureSession(Arrays.asList(surfaceHolder.getSurface(), mImageReader.getSurface()), new CameraCaptureSession.StateCallback() // ③</span><br><span class="line">        &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onConfigured(CameraCaptureSession cameraCaptureSession) &#123;</span><br><span class="line">                if (null == mCameraDevice) return;</span><br><span class="line">                // 当摄像头已经准备好时，开始显示预览</span><br><span class="line">                mCameraCaptureSession = cameraCaptureSession;</span><br><span class="line">                try &#123;</span><br><span class="line">                    // 自动对焦</span><br><span class="line">                    previewRequestBuilder.set(CaptureRequest.CONTROL_AF_MODE, CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_PICTURE);</span><br><span class="line">                    // 打开闪光灯</span><br><span class="line">                    previewRequestBuilder.set(CaptureRequest.CONTROL_AE_MODE, CaptureRequest.CONTROL_AE_MODE_ON_AUTO_FLASH);</span><br><span class="line">                    // 显示预览</span><br><span class="line">                    CaptureRequest previewRequest = previewRequestBuilder.build();</span><br><span class="line">                    mCameraCaptureSession.setRepeatingRequest(previewRequest, null, childHandler);</span><br><span class="line">                &#125; catch (CameraAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onConfigureFailed(CameraCaptureSession cameraCaptureSession) &#123;</span><br><span class="line">                Toast.makeText(MainActivity.this, &quot;配置失败&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, childHandler);</span><br><span class="line">    &#125; catch (CameraAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用相机拍照</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">//设置Surface旋转角</span><br><span class="line">    private static final SparseIntArray ORIENTATIONS = new SparseIntArray();</span><br><span class="line">    static &#123;</span><br><span class="line">        ORIENTATIONS.append(Surface.ROTATION_0,90);</span><br><span class="line">        ORIENTATIONS.append(Surface.ROTATION_90,0);</span><br><span class="line">        ORIENTATIONS.append(Surface.ROTATION_180,270);</span><br><span class="line">        ORIENTATIONS.append(Surface.ROTATION_270,180);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //imageReader初始化,！！！这个在初始化摄像头时赋值。</span><br><span class="line">    mImageReader = ImageReader.newInstance(mPreviewSize.getWidth(),</span><br><span class="line">    mPreviewSize.getHeight(),</span><br><span class="line">    ImageFormat.JPEG,</span><br><span class="line">    2 );                   </span><br><span class="line">     mImageReader.setOnImageAvailableListener(onImageAvailableListener , mBackgroundHandler);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public void takePicture()&#123;  </span><br><span class="line">    try &#123;  </span><br><span class="line">        CaptureRequest.Builder captureRequestBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_STILL_CAPTURE);  </span><br><span class="line">        // 将imageReader的surface作为CaptureRequest.Builder的目标  </span><br><span class="line">        captureRequestBuilder.addTarget(imageReader.getSurface());  </span><br><span class="line">        // 自动对焦  </span><br><span class="line">        captureRequestBuilder.set(CaptureRequest.CONTROL_AF_MODE, CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_PICTURE);  </span><br><span class="line">        // 获取手机方向  </span><br><span class="line">        int rotation = getWindowManager().getDefaultDisplay().getRotation();  </span><br><span class="line">        // 根据设备方向计算设置照片的方向  </span><br><span class="line">        captureRequestBuilder.set(CaptureRequest.JPEG_ORIENTATION, ORIENTATIONS.get(rotation));  </span><br><span class="line">        //拍照  </span><br><span class="line">        CaptureRequest mCaptureRequest = captureRequestBuilder.build();  </span><br><span class="line">        mSession.stopRepeating();  </span><br><span class="line">        mSession.capture(mCaptureRequest, null, mHandler);  </span><br><span class="line">    &#125; catch (CameraAccessException e) &#123;  </span><br><span class="line">        e.printStackTrace();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**监听拍照的图片*/</span><br><span class="line">   private ImageReader.OnImageAvailableListener imageAvailableListener= new ImageReader.OnImageAvailableListener()</span><br><span class="line">   &#123;</span><br><span class="line">       // 当照片数据可用时激发该方法</span><br><span class="line">       @Override</span><br><span class="line">       public void onImageAvailable(ImageReader reader) &#123;</span><br><span class="line"></span><br><span class="line">           //先验证手机是否有sdcard</span><br><span class="line">           String status = Environment.getExternalStorageState();</span><br><span class="line">           if (!status.equals(Environment.MEDIA_MOUNTED)) &#123;</span><br><span class="line">               Toast.makeText(getApplicationContext(), &quot;你的sd卡不可用。&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">               return;</span><br><span class="line">           &#125;</span><br><span class="line">           // 获取捕获的照片数据</span><br><span class="line">           Image image = reader.acquireNextImage();</span><br><span class="line">           ByteBuffer buffer = image.getPlanes()[0].getBuffer();</span><br><span class="line">           byte[] data = new byte[buffer.remaining()];</span><br><span class="line">           buffer.get(data);</span><br><span class="line"></span><br><span class="line">           //手机拍照都是存到这个路径</span><br><span class="line">           String filePath = Environment.getExternalStorageDirectory().getPath() + &quot;/DCIM/Camera/&quot;;</span><br><span class="line">           String picturePath = System.currentTimeMillis() + &quot;.jpg&quot;;</span><br><span class="line">           File file = new File(filePath, picturePath);</span><br><span class="line">           try &#123;</span><br><span class="line">               //存到本地相册</span><br><span class="line">               FileOutputStream fileOutputStream = new FileOutputStream(file);</span><br><span class="line">               fileOutputStream.write(data);</span><br><span class="line">               fileOutputStream.close();</span><br><span class="line"></span><br><span class="line">               //显示图片</span><br><span class="line">               BitmapFactory.Options options = new BitmapFactory.Options();</span><br><span class="line">               options.inSampleSize = 2;</span><br><span class="line">               Bitmap bitmap = BitmapFactory.decodeByteArray(data, 0, data.length, options);</span><br><span class="line">               iv.setImageBitmap(bitmap);</span><br><span class="line">           &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">           &#125; catch (IOException e) &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">           &#125; finally &#123;</span><br><span class="line">               image.close();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用相机录像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">//设置MediaRecoder属性</span><br><span class="line">private void setUpMediaRecorder() throws IOException &#123;</span><br><span class="line">       //设置音频源</span><br><span class="line">       mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);</span><br><span class="line">       //设置视频源</span><br><span class="line">       mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE);</span><br><span class="line">       mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);</span><br><span class="line">       //存储路径</span><br><span class="line">       if (mNextVideoAbsolutePath == null || mNextVideoAbsolutePath.isEmpty()) &#123;</span><br><span class="line">           mNextVideoAbsolutePath = getVideoFilePath(getApplicationContext());</span><br><span class="line">       &#125;</span><br><span class="line">       mMediaRecorder.setOutputFile(mNextVideoAbsolutePath);</span><br><span class="line">       mMediaRecorder.setVideoEncodingBitRate(10000000);</span><br><span class="line">       mMediaRecorder.setVideoFrameRate(30);</span><br><span class="line">       //视屏宽高</span><br><span class="line">       mMediaRecorder.setVideoSize(mVideoSize.getWidth(), mVideoSize.getHeight());</span><br><span class="line">       //视屏编码格式</span><br><span class="line">       mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);</span><br><span class="line">       //音频编码格式</span><br><span class="line">       mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);</span><br><span class="line">       int rotation = getWindowManager().getDefaultDisplay().getRotation();</span><br><span class="line">       switch (mSensorOrientation) &#123;</span><br><span class="line">           case SENSOR_ORIENTATION_DEFAULT_DEGREES:</span><br><span class="line">               mMediaRecorder.setOrientationHint(DEFAULT_ORIENTATIONS.get(rotation));</span><br><span class="line">               break;</span><br><span class="line">           case SENSOR_ORIENTATION_INVERSE_DEGREES:</span><br><span class="line">               mMediaRecorder.setOrientationHint(INVERSE_ORIENTATIONS.get(rotation));</span><br><span class="line">               break;</span><br><span class="line">       &#125;</span><br><span class="line">       mMediaRecorder.prepare();</span><br><span class="line">   &#125;</span><br><span class="line">   //视频录制</span><br><span class="line">private void startRecordingVideo() &#123;</span><br><span class="line">        if (null == mCameraDevice || !textureView.isAvailable() || null == mPreviewSize) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            closePreviewSession();</span><br><span class="line">            setUpMediaRecorder();</span><br><span class="line">            SurfaceTexture texture = textureView.getSurfaceTexture();</span><br><span class="line">            assert texture != null;</span><br><span class="line">            texture.setDefaultBufferSize(mPreviewSize.getWidth(), mPreviewSize.getHeight());</span><br><span class="line">            mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);</span><br><span class="line">            List&lt;Surface&gt; surfaces = new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            // Set up Surface for the camera preview</span><br><span class="line">            Surface previewSurface = new Surface(texture);</span><br><span class="line">            surfaces.add(previewSurface);</span><br><span class="line">            mPreviewBuilder.addTarget(previewSurface);</span><br><span class="line"></span><br><span class="line">            // Set up Surface for the MediaRecorder</span><br><span class="line">            Surface recorderSurface = mMediaRecorder.getSurface();</span><br><span class="line">            surfaces.add(recorderSurface);</span><br><span class="line">            mPreviewBuilder.addTarget(recorderSurface);</span><br><span class="line"></span><br><span class="line">            // Start a capture session</span><br><span class="line">            // Once the session starts, we can update the UI and start recording</span><br><span class="line">            mCameraDevice.createCaptureSession(surfaces, new CameraCaptureSession.StateCallback() &#123;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                public void onConfigured(@NonNull CameraCaptureSession cameraCaptureSession) &#123;</span><br><span class="line">                    mPreviewSession = cameraCaptureSession;</span><br><span class="line">                    updatePreview();</span><br><span class="line">                    runOnUiThread(new Runnable() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void run() &#123;</span><br><span class="line">                            // UI</span><br><span class="line">                            button.setText(&quot;stop&quot;);</span><br><span class="line">                            mIsRecordingVideo = true;</span><br><span class="line"></span><br><span class="line">                            // Start recording</span><br><span class="line">                            mMediaRecorder.start();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                public void onConfigureFailed(@NonNull CameraCaptureSession cameraCaptureSession) &#123;</span><br><span class="line">                    Toast.makeText(getApplicationContext(), &quot;Failed&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, mBackgroundHandler);</span><br><span class="line">        &#125; catch (CameraAccessException | IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>录像主要时通过TextureView实现实时预览，同时使用MediaRecorder录制视屏。</p>
<p>参考：<br>[1]. Camera2完全解析 <a href="https://www.jianshu.com/p/d83161e77e90" target="_blank" rel="noopener">https://www.jianshu.com/p/d83161e77e90</a><br>[2]. Camera2介绍 <a href="https://blog.csdn.net/vinicolor/article/details/50992692" target="_blank" rel="noopener">https://blog.csdn.net/vinicolor/article/details/50992692</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cattlefoot.github.io/2018/06/22/androidCamera2使用/" data-id="cjl6atndf000v7ls6wfb0turg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Camera2/">Camera2</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/andrid/">andrid</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/06/22/Activity启动模式/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          android启动模式
        
      </div>
    </a>
  
  
    <a href="/2018/06/15/webpack4安装使用/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">webpack4安装使用</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/7/">7</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android-Studio/">Android Studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android-Support/">Android Support</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Annotation/">Annotation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AsynListUtil/">AsynListUtil</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AsyncListUtil-DataCallback/">AsyncListUtil.DataCallback</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AsyncListUtil-ViewCallback/">AsyncListUtil.ViewCallback</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bitmap/">Bitmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BitmapFactory/">BitmapFactory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Buffer/">Buffer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ByteBuffer/">ByteBuffer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Camera2/">Camera2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Download-Manager/">Download Manager</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DynamicLoadApk/">DynamicLoadApk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Error/">Error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/First-App/">First App</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flutter/">Flutter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Instant-Run/">Instant Run</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Interceptors/">Interceptors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LinearLayout/">LinearLayout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVC-MVP-MVVM/">MVC MVP MVVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Media/">Media</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MediaCodeC/">MediaCodeC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MediaExtractor/">MediaExtractor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MulitiDex/">MulitiDex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NIO/">NIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NNotificationChannelGroup/">NNotificationChannelGroup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NestedScrolling/">NestedScrolling</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notification/">Notification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NotificationChannel/">NotificationChannel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Options/">Options</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Singleton/">Singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Small/">Small</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SourceCode/">SourceCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Support/">Support</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tool/">Tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Uri/">Uri</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/andrid/">andrid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/camera2/">camera2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle-plugin/">gradle plugin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/head/">head</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ide/">ide</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/install/">install</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macOS/">macOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/okhttp/">okhttp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/start/">start</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/7/" style="font-size: 10px;">7</a> <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Android-Studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/Android-Support/" style="font-size: 10px;">Android Support</a> <a href="/tags/Annotation/" style="font-size: 12.5px;">Annotation</a> <a href="/tags/AsynListUtil/" style="font-size: 10px;">AsynListUtil</a> <a href="/tags/AsyncListUtil-DataCallback/" style="font-size: 10px;">AsyncListUtil.DataCallback</a> <a href="/tags/AsyncListUtil-ViewCallback/" style="font-size: 10px;">AsyncListUtil.ViewCallback</a> <a href="/tags/Bitmap/" style="font-size: 10px;">Bitmap</a> <a href="/tags/BitmapFactory/" style="font-size: 10px;">BitmapFactory</a> <a href="/tags/Buffer/" style="font-size: 10px;">Buffer</a> <a href="/tags/ByteBuffer/" style="font-size: 10px;">ByteBuffer</a> <a href="/tags/Camera2/" style="font-size: 12.5px;">Camera2</a> <a href="/tags/Download-Manager/" style="font-size: 12.5px;">Download Manager</a> <a href="/tags/DynamicLoadApk/" style="font-size: 10px;">DynamicLoadApk</a> <a href="/tags/Error/" style="font-size: 10px;">Error</a> <a href="/tags/First-App/" style="font-size: 10px;">First App</a> <a href="/tags/Flutter/" style="font-size: 17.5px;">Flutter</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/Instant-Run/" style="font-size: 10px;">Instant Run</a> <a href="/tags/Interceptors/" style="font-size: 10px;">Interceptors</a> <a href="/tags/LinearLayout/" style="font-size: 10px;">LinearLayout</a> <a href="/tags/MVC-MVP-MVVM/" style="font-size: 10px;">MVC MVP MVVM</a> <a href="/tags/Media/" style="font-size: 15px;">Media</a> <a href="/tags/MediaCodeC/" style="font-size: 10px;">MediaCodeC</a> <a href="/tags/MediaExtractor/" style="font-size: 12.5px;">MediaExtractor</a> <a href="/tags/MulitiDex/" style="font-size: 10px;">MulitiDex</a> <a href="/tags/NIO/" style="font-size: 10px;">NIO</a> <a href="/tags/NNotificationChannelGroup/" style="font-size: 10px;">NNotificationChannelGroup</a> <a href="/tags/NestedScrolling/" style="font-size: 10px;">NestedScrolling</a> <a href="/tags/Notification/" style="font-size: 10px;">Notification</a> <a href="/tags/NotificationChannel/" style="font-size: 10px;">NotificationChannel</a> <a href="/tags/Options/" style="font-size: 10px;">Options</a> <a href="/tags/Singleton/" style="font-size: 10px;">Singleton</a> <a href="/tags/Small/" style="font-size: 10px;">Small</a> <a href="/tags/SourceCode/" style="font-size: 10px;">SourceCode</a> <a href="/tags/Support/" style="font-size: 10px;">Support</a> <a href="/tags/Tool/" style="font-size: 12.5px;">Tool</a> <a href="/tags/Uri/" style="font-size: 10px;">Uri</a> <a href="/tags/andrid/" style="font-size: 15px;">andrid</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/camera2/" style="font-size: 10px;">camera2</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/gradle-plugin/" style="font-size: 10px;">gradle plugin</a> <a href="/tags/head/" style="font-size: 10px;">head</a> <a href="/tags/ide/" style="font-size: 10px;">ide</a> <a href="/tags/install/" style="font-size: 12.5px;">install</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/macOS/" style="font-size: 10px;">macOS</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/okhttp/" style="font-size: 10px;">okhttp</a> <a href="/tags/start/" style="font-size: 10px;">start</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/23/NIO-Buffer解析/">NIO-Buffer解析</a>
          </li>
        
          <li>
            <a href="/2018/08/16/根据Uri获取文档的路径/">根据Uri获取文档的路径</a>
          </li>
        
          <li>
            <a href="/2018/08/12/LinearLayout源码解读/">LinearLayout源码解读</a>
          </li>
        
          <li>
            <a href="/2018/07/22/android-camera2预览拍照录制/">android-camera2预览拍照录制</a>
          </li>
        
          <li>
            <a href="/2018/07/17/http之head解析/">http之head解析</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 CallteFoot<br>
      Powered by <a href="https://cattlefoot.github.io" target="_blank">CallteFoot</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>